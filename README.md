# Watermarking Machine-Generated Text
This repository contains the code for our senior project "Watermarking Machine-Generated Text".
<!-- create a table with notebooks and Datasets as header -->

## **No Attacks**
| Description | Notebooks | Datasets |
| --- | --- | --- |
| 1. Create a dataset of Unwatermarked Text | [Notebook](./Notebooks/No%20Attacks/Automated%20Watermarking%20and%20Detection/Unwatermarked/create-unwatermarked-dataset.ipynb) | [Dataset](./Datasets/No%20Attacks/Unwatermarking/generated_texts.csv) |
| 2. Test Watermarking and Detection Algorithms| [Logits Deviation with Green-Red List](./Notebooks/No%20Attacks/Manual%20Watermarking%20and%20Detection/logits-deviation-with-green-red-list-v1-FAIL.ipynb) <br>  [Sampling With Randomized Numbers using TinyLlama](./Notebooks/No%20Attacks/Manual%20Watermarking%20and%20Detection/sampling-with-randomized-numbers-TinyLlama.ipynb) <br>  [Logits Deviation with Randomized Numbers using OPT-350M](./Notebooks/No%20Attacks/Manual%20Watermarking%20and%20Detection/sampling-with-randomized-opt-350m.ipynb) | N/A |
| 3. Automate Watermarking Using the [Sunbird Dataset](https://www.kaggle.com/datasets/mekaneeky/sunbird-english-prompts)   |  [Part 1](./Notebooks/No%20Attacks/Automated%20Watermarking%20and%20Detection/Watermarking/create-watermarked-dataset-part-1.ipynb) <br>  [Part 2](./Notebooks/No%20Attacks/Automated%20Watermarking%20and%20Detection/Watermarking/create-watermarked-dataset-part-2.ipynb) <br>  [Part 3](./Notebooks/No%20Attacks/Automated%20Watermarking%20and%20Detection/Watermarking/create-watermarked-dataset-part-3.ipynb) <br>  [Merge](./Notebooks/No%20Attacks/Automated%20Watermarking%20and%20Detection/Merge%20Datasets/create-merged-watermarked-text-dataset.ipynb)| [Part 1](./Datasets/No%20Attacks/Watermarking/watermarked-texts-part-1.csv) <br> [Part 2](./Datasets/No%20Attacks/Watermarking/watermarked-texts-part-2.csv) <br> [Part 3](./Datasets/No%20Attacks/Watermarking/watermarked-texts-part-3.csv) <br> [Merged](./Datasets/No%20Attacks/Merged/merged-watermarked-and-unwatermarked-text.csv) |
| 4. Merge Unwatermarked and Watermarked Datasets | [Merge](./Notebooks/No%20Attacks/Automated%20Watermarking%20and%20Detection/Merge%20Datasets/create-merged-watermarked-and-unwatermarked-dataset.ipynb) <br> [Truncate](./Notebooks/No%20Attacks/Automated%20Watermarking%20and%20Detection/Merge%20Datasets/create-truncated-watermarked-and-unwatermarked-dataset.ipynb) | [Merged](./Datasets/No%20Attacks/Merged/merged-watermarked-and-unwatermarked-text.csv) <br> [Truncated](./Datasets/No%20Attacks/Merged/truncated-watermarked-and-unwatermarked-text.csv) |
| 5. Run the Detection Algorithm on the first 1200 rows of the Truncated Dataset | [Part1](./Notebooks/No%20Attacks/Automated%20Watermarking%20and%20Detection/Detection/create-pvalue-scores-dataset-part-1.ipynb) <br> [Part2](./Notebooks/No%20Attacks/Automated%20Watermarking%20and%20Detection/Detection/create-pvalue-scores-dataset-part-2.ipynb) <br> [Part3](./Notebooks/No%20Attacks/Automated%20Watermarking%20and%20Detection/Detection/create-pvalue-scores-dataset-part-3.ipynb) <br> [Merge](./Notebooks/No%20Attacks/Automated%20Watermarking%20and%20Detection/Merge%20Datasets/create-merged-pvalue-scores-dataset.ipynb)| [Part1](./Datasets/No%20Attacks/Detection/p-value-label-part-1.csv) <br> [Part2](./Datasets/No%20Attacks/Detection/p-value-label-part-2.csv) <br> [Part3](./Datasets/No%20Attacks/Detection/p-value-label-part-3.csv) <br> [Merged](./Datasets/No%20Attacks/Merged/merged-p-value-label.csv) |
| 6. Evaluate the Accuracy, Precision, Recall and F1-score  of the Detection Algorithm | [Notebook](./Notebooks/No%20Attacks/Automated%20Watermarking%20and%20Detection/Detection/evaluate-the-detection-algorithm.ipynb) | N/A |

## **Simulating and Counteracting Attacks**
### **1. Paraphrasing Attack**
| Description | Notebooks | Datasets |
| --- | --- | --- |
|1. Experimented paraphrasing using Dipper | [Notebook](./Notebooks/Attacks/Paraphrasing%20Attack/Dipper/Dipper%20-%20v1.ipynb) | N/A |
|2. Experimented paraphrasing using T5 on the [Watermarked Dataset](./Datasets/No%20Attacks/Merged/truncated-watermarked-and-unwatermarked-text.csv)| [Notebook](./Notebooks/Attacks/Paraphrasing%20Attack/T5/t5-generated-text-and-paraphrased-only.ipynb) | [Dataset](./Datasets/Attacks/Paraphrasing%20attack/paraphased-text.csv) |
|3. Run the Detection Algorithm on the [Paraphrased Dataset](./Datasets/Attacks/Paraphrasing%20attack/paraphased-text.csv) | [Part1](./Notebooks/Attacks/Paraphrasing%20Attack/Detection/detection-paraphrased-part-1.ipynb) <br> [Part2](./Notebooks/Attacks/Paraphrasing%20Attack/Detection/detection-paraphrased-part2.ipynb) <br> [Part3](./Notebooks/Attacks/Paraphrasing%20Attack/Detection/detection-paraphrased-part3.ipynb) <br> [Merge](./Notebooks/Attacks/Paraphrasing%20Attack/Detection/merge-detection-paraphrased.ipynb)| [Part1](./Datasets/Attacks/Paraphrasing%20attack/Detection/paraphrasing_test_results-part%201.csv) <br> [Part2](./Datasets/Attacks/Paraphrasing%20attack/Detection/paraphrasing_test_results-part%202.csv) <br> [Part3](./Datasets/Attacks/Paraphrasing%20attack/Detection/paraphrasing_test_results-part3.csv) <br> [Merged](./Datasets/Attacks/Paraphrasing%20attack/Detection/merged-data-paraphrasing-detection.csv) |
|4. Evaluate the Accuracy, Precision, Recall and F1-score  of the Detection Algorithm after Paraphrasing| [Notebook](./Notebooks/Attacks/Paraphrasing%20Attack/Detection/evaluate-model-after-paraphrasing.ipynb) | N/A |
|5. Experimented paraphrasing using Roundtrip paraphrasing (English to French to English) on the [Watermarked Dataset](./Datasets/No%20Attacks/Merged/truncated-watermarked-and-unwatermarked-text.csv)| [Notebook](./Notebooks/Attacks/Paraphrasing%20Attack/RT%20paraphrasing/roundtrip.ipynb) | [Dataset](./Datasets/Attacks/Paraphrasing%20attack/RT%20paraphrasing/paraphrased_data_fr.csv) |
|6. Run the Detection Algorithm on the [Paraphrased Dataset](./Datasets/Attacks/Paraphrasing%20attack/paraphased-text.csv) | [Part1](./Notebooks/Attacks/Paraphrasing%20Attack/RT%20paraphrasing/Detection/rt-detection-part-1.ipynb) <br> [Part2](./Notebooks/Attacks/Paraphrasing%20Attack/RT%20paraphrasing/Detection/rt-detection-part-2.ipynb) <br> [Part3](.) <br> [Merge](./Notebooks/Attacks/Paraphrasing%20Attack/RT%20paraphrasing/Detection/merge-detection-rt-paraphrased.ipynb)| [Part1](./Datasets/Attacks/Paraphrasing%20attack/RT%20paraphrasing/Detection/paraphrasing_test_results_part1.csv) <br> [Part2](./Datasets/Attacks/Paraphrasing%20attack/RT%20paraphrasing/Detection/paraphrasing_test_results_part2.csv) <br> [Part3](./Datasets/Attacks/Paraphrasing%20attack/RT%20paraphrasing/Detection/paraphrasing_test_results_part3.csv) <br> [Merged](./Datasets/Attacks/Paraphrasing%20attack/RT%20paraphrasing/Detection/detection_merged_data.csv) |
|7. Evaluate the Accuracy, Precision, Recall and F1-score  of the Detection Algorithm after RT Paraphrasing| [Notebook](./Notebooks/Attacks/Paraphrasing%20Attack/RT%20paraphrasing/Detection/evaluate-model-after-rt-paraphrasing.ipynb) | N/A |

### **2. Homoglyph Attack**
| Description | Notebooks | Datasets |
| --- | --- | --- |
| 1. Simulate Homoglyph Attack on the [Watermarked Dataset](./Datasets/No%20Attacks/Merged/truncated-watermarked-and-unwatermarked-text.csv)| [Notebook](./Notebooks/Attacks/Homoglyph%20Attack/homoglyph-attack-v1-2.ipynb) | [Dataset](./Datasets/Attacks/Homoglyph%20Attack/homoglyph_data_v2.csv) |
| 2. Run the Detection Algorithm on the [Homoglyph Text](./Datasets/Attacks/Homoglyph%20Attack/homoglyph_data.csv) | [Part1](./Notebooks/Attacks/Homoglyph%20Attack/Detection/detection-homoglyph-part1.ipynb) <br> [Part2](./Notebooks/Attacks/Homoglyph%20Attack/Detection/detection-homoglyph-part2.ipynb) <br> [Part3](./Notebooks/Attacks/Homoglyph%20Attack/Detection/detection-homoglyph-part3.ipynb) <br> [Merge](./Notebooks/Attacks/Homoglyph%20Attack/Detection/merge-homoglyph-detection.ipynb)| [Part1](./Datasets/Attacks/Homoglyph%20Attack/Detection/homoglyph_test_results_part1.csv) <br> [Part2](./Datasets/Attacks/Homoglyph%20Attack/Detection/homogylph_test_results_part2.csv) <br> [Part3](./Datasets/Attacks/Homoglyph%20Attack/Detection/homoglyph_test_results_part3.csv) <br> [Merged](./Datasets/Attacks/Homoglyph%20Attack/Detection/merged_homoglyph_datasets.csv) |
| 3. Evaluate the Accuracy, Precision, Recall and F1-score  of the Detection Algorithm after applying Homoglyph Attack| [Notebook](./Notebooks/Attacks/Homoglyph%20Attack/Detection/evaluate-homoglyph.ipynb) | N/A |
| 4. Counteract the Homoglyph Attack | [Notebook](./Notebooks/Attacks/Homoglyph%20Attack/homoglyph-attack-and-counteracting-v2.ipynb) | [Dataset](./Datasets/Attacks/Homoglyph%20Attack/normalized_data.csv)|

### **3. Zero-Width Attack**
| Description | Notebooks | Datasets |
| --- | --- | --- |
| 1. Simulate Zero-width attack on watermarked text | [Notebook](./Notebooks/Attacks/Zero%20Width%20Attack/Simulate%20Attack/zero-width-attack.ipynb)| [Dataset](./Datasets/Attacks/Zero%20Width%20attack/Simulate%20Attack/zero-width-attacked-text.csv)|
| 2. Run the Detection Algorithm on the first 100 samples from the [Zero-width Attacked Dataset](./Datasets/Attacks/Zero%20Width%20Attack/Simulate%20Attack/zero-width-attacked-text.csv)| [Part 1](./Notebooks/Attacks/Zero%20Width%20Attack/Detection/create-pvalue-scores-dataset-zero-width-part-1.ipynb) <br> [Part 2](./Notebooks/Attacks/Zero%20Width%20Attack/Detection/create-pvalue-scores-dataset-zero-width-part-2.ipynb) <br> [Part 3](./Notebooks/Attacks/Zero%20Width%20Attack/Detection/create-pvalue-scores-dataset-zero-width-part-3.ipynb) <br> [Merge](./Notebooks/Attacks/Zero%20Width%20Attack/Merge%20Datasets/create-merged-pvalue-scores-zero-width-dataset.ipynb) | [Part 1](./Datasets/Attacks/Zero%20Width%20attack/Detection/p-value-label-part-1.csv) <br> [Part 2](./Datasets/Attacks/Zero%20Width%20attack/Detection/p-value-label-part-2.csv) <br> [Part 3](./Datasets/Attacks/Zero%20Width%20attack/Detection/p-value-label-part-3.csv) <br> [Merged](./Datasets/Attacks/Zero%20Width%20attack/Merge%20Datasets/p-values%20zero-width%20attack.csv) |
| 3. Evaluate the Accuracy, Precision, Recall and F1-score  of the Detection Algorithm after Zero-Width Attack **without** counteracting | [Notebook](./Notebooks/Attacks/Zero%20Width%20Attack/Detection/evaluate-the-detection-algorithm-zero-width-no-counteracting.ipynb) | N/A |
| 4. Counteract the Zero-Width Attack | [Notebook](./Notebooks/Attacks/Zero%20Width%20Attack/Counteract%20Attack/counteract-zwc-v1-0.ipynb) | [Dataset](./Datasets/Attacks/Zero%20Width%20attack/Counteract%20Attack/recovered_ZW_data.csv) |

### **4. Bidirectional Reordering Attack**
| Description | Notebooks | Datasets |
| --- | --- | --- |
| 1. Simulate Bidirectional Reordering attack on watermarked text | [Notebook](./Notebooks/Attacks/Bidirectional%20Reordering%20Attack/bidi-attack.ipynb)| [Dataset](./Datasets/Attacks/Bidirectional%20Reordering%20Attack/bidi_reordered_attacked.csv)|
| 2. Run the Detection Algorithm on the first fews samples from the [Bidirectional Reordering Attack Dataset](./Datasets/Attacks/Bidirectional%20Reordering%20Attack/bidi_reordered_attacked.csv)| [Part 1](./Notebooks/Attacks/Bidirectional%20Reordering%20Attack/detection-opt-350m-reordering-taher.ipynb)| [Part 1](./Datasets/Attacks/Bidirectional%20Reordering%20Attack/permutation_test_results_bidi.csv)|
---
## **Evaluating LLM With and Without Watermark**
***EXPERIMENTAL***
| Description | Notebooks | Datasets |
| --- | --- | --- |
|1. Evaluate OPT-350M (No Watermark) using the [HellaSwag Dataset](https://www.github.com/rowanz/hellaswag) | [MCQ FAIL](./Notebooks/No%20Attacks/Evaluation/Automated%20Evaluation/opt-350m-mcq-hellaswag-v1.ipynb) <br> [Auto-Complete FAIL](./Notebooks/No%20Attacks/Evaluation/Automated%20Evaluation/opt-350m-autocomplete-hellaswag-v1.ipynb)<br>[Minimum Loss](./Notebooks/No%20Attacks/Evaluation/Automated%20Evaluation/hellaswag-eval-loss-v1.ipynb)<br> [MMLU Notebook Adaptation](./Notebooks/No%20Attacks/Evaluation/Automated%20Evaluation/hellaswag-eval-maxnewtoken1-v2.ipynb) <br> [MMLU Notebook Adaptation Results Analysis](./Notebooks/No%20Attacks/Evaluation/Automated%20Evaluation/hellaswag-eval-maxnewtoken1-v2-analysis-v1.ipynb) <br> [MMLU Adaptation with one example and Analysis](./Notebooks/No%20Attacks/Evaluation/Automated%20Evaluation/hellaswag-eval-maxnewtoken1-v3-one-example-analysis.ipynb)| [MCQ](./Datasets/No%20Attacks/Evaluation/Automated%20Evaluation/opt_few_shot_results_mcq.csv) <br> [Auto-Complete](./Datasets/No%20Attacks/Evaluation/Automated%20Evaluation/opt_few_shot_results_autocomplete.csv) <br> [MMLU Notebook Adaptation Output](./Datasets/No%20Attacks/Evaluation/Automated%20Evaluation/evaluation_OPT_350mb.csv)<br> [MMLU Notebook Adaptation Metrics Input](./Datasets/No%20Attacks/Evaluation/Automated%20Evaluation/run_results_OPT_350mb.csv)<br>[MMLU Adaptation with one example](./Datasets/No%20Attacks/Evaluation/Automated%20Evaluation/evaluation_OPT_350mb-one-example.csv)|
|***FAILED & ABANDONED*** Evaluate GEMMA-2B (No Watermark) using the [HellaSwag Dataset](https://www.github.com/rowanz/hellaswag) | [MCQ and Auto-Complete FAIL](./Notebooks/No%20Attacks/Evaluation/Automated%20Evaluation/gemma-mcq-and-autocomplete-v1-FAIL.ipynb) | N/A |
|2. Evaluate OPT-350M (With Watermark) using the [HellaSwag Dataset](https://www.github.com/rowanz/hellaswag) | [Logits with Red-Green List (Minimum Loss) FAIL](./Notebooks/No%20Attacks/Evaluation/Automated%20Evaluation/opt350m-evaluating-a-watermark-for-llm-fail-v1.ipynb)| N/A |
| 3. Evaluate OPT-350M (Without watermark) using the [MMLU Dataset](https://github.com/hendrycks/test)| [MCQ Eval for all categories](./Notebooks/No%20Attacks/Evaluation/Automated%20Evaluation/mmlu-opt-350m-eval-without-watermark-v1.ipynb)| N/A |
| 4. Evaluate OPT-350M (With watermark) using the [MMLU Dataset](https://github.com/hendrycks/test)| N/A | N/A|
| 5. Evaluate OPT-350M (Without watermark) using the [TruthfulQA Dataset](https://github.com/sylinrl/TruthfulQA)| [Evaluation using ROUGE, BLEU, BLEURT](./Notebooks/No%20Attacks/Evaluation/Automated%20Evaluation/truthfulqa-opt-350m-eval-without-watermark-v1.ipynb)| N/A |
| 6. Evaluate OPT-350M (With watermark) using the [TruthfulQA Dataset](https://github.com/sylinrl/TruthfulQA)| N/A | N/A |
